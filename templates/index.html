{% extends "base.html" %}
{% block content %}
  <section class="section">
    <h1 class="h1">Материалы курса</h1>
    <p class="muted">
      Материалы курса. Для связи с администратором
      <a class="link" href="https://t.me/numresearch" target="_blank" rel="noopener">t.me/numresearch</a>
    </p>
  </section>

  {% if not cards %}
    <div class="empty">
      Пока нет карточек.
    </div>
  {% endif %}

  <div class="grid">
    {% for c in cards %}
      <article class="card">
        <div class="card__top">
          <div class="card__title">{{ c.title }}</div>
          <div class="card__meta">{{ c.created_at }}</div>
        </div>

        {% if c.description %}
          <div class="card__desc">{{ c.description }}</div>
        {% endif %}

        {% if c.files and c.files|length > 0 %}
          <div class="attachments">
            {% for f in c.files %}
              {% set ext = f.ext|lower %}
              {% if ext in ["jpg","jpeg","png","gif","webp"] %}
                <a class="att att-img" href="{{ f.url }}" target="_blank" rel="noopener">
                  <img src="{{ f.url }}" alt="{{ f.name }}">
                </a>
              {% elif ext in ["mp4","webm","mov"] %}
                <div class="att att-video">
                  <video controls preload="metadata" src="{{ f.url }}"></video>
                  <div class="att__name">{{ f.name }}</div>
                </div>
              {% else %}
                <a class="att att-file" href="{{ f.url }}" target="_blank" rel="noopener">
                  <span class="att__icon">⬇</span>
                  <span class="att__name">{{ f.name }}</span>
                </a>
              {% endif %}
            {% endfor %}
          </div>
        {% endif %}
      </article>
    {% endfor %}
  </div>
{% endblock %}
